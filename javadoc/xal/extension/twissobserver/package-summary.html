<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_31) on Thu Feb 05 15:44:37 EST 2015 -->
<title>xal.extension.twissobserver</title>
<meta name="date" content="2015-02-05">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="xal.extension.twissobserver";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../xal/extension/solver/solutionjudge/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../xal/extension/widgets/apputils/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?xal/extension/twissobserver/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;xal.extension.twissobserver</h1>
<div class="docSummary">
<div class="block">
 The twissobserver package contains tools for computing the Courant-Snyder parameters
 <b>&sigma;</b> at a hardware location along the beamline from the RMS beam sizes downstream of that
 that location.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/CsFixedPtEstimator.IProgressListener.html" title="interface in xal.extension.twissobserver">CsFixedPtEstimator.IProgressListener</a></td>
<td class="colLast">
<div class="block">Interface defining the methods to implement for a class that wishes to
 monitor the progress of solution computation.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/BunchLengthSimulator.html" title="class in xal.extension.twissobserver">BunchLengthSimulator</a></td>
<td class="colLast">
<div class="block">This class is an auxiliary tool for providing the longitudinal component of a 
 <code><a href="../../../xal/extension/twissobserver/Measurement.html" title="class in xal.extension.twissobserver"><code>Measurement</code></a></code> object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/CourantSnyderEstimator.html" title="class in xal.extension.twissobserver">CourantSnyderEstimator</a></td>
<td class="colLast">
<div class="block">
 Base class for the problem of reconstructing Courant-Snyder parameters from beam profile
 data at multiple locations along a beamline.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/CsContinuationEstimator.html" title="class in xal.extension.twissobserver">CsContinuationEstimator</a></td>
<td class="colLast">
<div class="block">
 Computes the covariance matrix at a given location which is most likely to produce the provided
 data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/CsFixedPtEstimator.html" title="class in xal.extension.twissobserver">CsFixedPtEstimator</a></td>
<td class="colLast">
<div class="block">
 Computes the twiss parameters from wire scanner data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/CsZeroCurrentEstimator.html" title="class in xal.extension.twissobserver">CsZeroCurrentEstimator</a></td>
<td class="colLast">
<div class="block">Reconstructs the zero-current second-order beam moments from multiple profile data measurements
 along a beamline.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/Measurement.html" title="class in xal.extension.twissobserver">Measurement</a></td>
<td class="colLast">
<div class="block">
 Data structure containing beam size measurements at a specific beamline
 location.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/MeasurementCurve.html" title="class in xal.extension.twissobserver">MeasurementCurve</a></td>
<td class="colLast">
<div class="block">This class represents a curve within a graph 
 (see <code><code>FunctionGrpahsJPanel</code><code> and
 child class <code><a href="../../../xal/extension/widgets/olmplot/TrajectoryGraph.html" title="class in xal.extension.widgets.olmplot"><code>TrajectoryGraph</code></a></code>) containing
 measurement data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/TransferMatrixGenerator.html" title="class in xal.extension.twissobserver">TransferMatrixGenerator</a></td>
<td class="colLast">
<div class="block">
 Class for generating transfer matrices for the XAL accelerator beamlines.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/PHASEPLANE.html" title="enum in xal.extension.twissobserver">PHASEPLANE</a></td>
<td class="colLast">
<div class="block">Enumeration of the mechanical motion phase planes for use in 
 identifying the families of Courant-Snyder parameters.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/TransferMatrixGenerator.SYNC.html" title="enum in xal.extension.twissobserver">TransferMatrixGenerator.SYNC</a></td>
<td class="colLast">
<div class="block">Enumeration set representing the possible synchronization modes of the
 <code><a href="../../../xal/sim/scenario/Scenario.html" title="class in xal.sim.scenario"><code>Scenario</code></a></code> class.</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Exception Summary table, listing exceptions, and an explanation">
<caption><span>Exception Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Exception</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../xal/extension/twissobserver/ConvergenceException.html" title="class in xal.extension.twissobserver">ConvergenceException</a></td>
<td class="colLast">
<div class="block">Exception thrown when iterative process does not converge to a
 solution.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package xal.extension.twissobserver Description">Package xal.extension.twissobserver Description</h2>
<div class="block"><p>
 The twissobserver package contains tools for computing the Courant-Snyder parameters
 <b>&sigma;</b> at a hardware location along the beamline from the RMS beam sizes downstream of that
 that location.  Rather than running a model of the beamline and adjusting the initial
 conditions of the beam (i.e., the Courant-Snyder parameters) until a chi-squared fit
 of the model results to the data is achieved, the tools in this package create an 
 automorphic map <b>F</b> from the Courant-Snyder parameter domain to itself.  This is direct
 approach to the problem rather than the "weak" solution found by the fitting technique where the 
 Courant-Snyder parameters minimizing a functional.  
 Here the map is iterated to the fixed point of <b>F</b>, the fixed point 
 <b>&sigma;</b> = <b>F&sigma;</b> being the solution of Courant-Snyder parameters.
 </p>
 <p>
 Let <b>T</b> : <i>CS</i> &rarr; <i>D</i> be the map that takes Courant-Snyder parameters to
 the set of RMS beam sizes along the beamline.  The map <b>T</b> is computed numerically by
 as a cascade of transfer maps along the beamline from the reconstruction location to each of 
 the data locations.  We assume there are at least as many data
 points as there are Courant-Snyder parameters so that |<i>CS</i>| &le; |<i>D</i>|.  Then the 
 least-squares solution <b>&sigma;</b> to the reconstruction problem is
 <br/>
 <br/>
 &nbsp; &nbsp; <b>&sigma;</b> = (<b>T</b><sup>*</sup><b>T</b>)<sup>-1</sup><b>T</b><sup>*</sup><b>d</b> ,
 <br/>
 <br/>
 where <b>T</b><sup>*</sup> is the adjoint of <b>T</b> and <b>d</b> is the vector of RMS beam
 sizes (i.e., the data).  When no space charge is present <b>T</b> is a linear map and this
 equation may be solved directly.  
 </p>
 <p>
 When no space charge is present, indicated by <i>I</i> &gt> 0 where <i>I</i> is the generalized
 beam current, the map <t> now depends upon the initial Courant-Snyder parameters, that is
 <b>T</b> = <b>T</b>(<b>&sigma;</b>).  For any given beam current <i>I</i> we define the map 
 <b>F</b> : <i>CS</i> &rarr; <i>CS</i> as 
 <br/>
 <br>
 &nbsp; &nbsp; <b>F</b>(<b>&sigma;</b>,<i>I</i>) &#8796; [<b>T</b><sup>*</sup><b>(<b>&sigma;</b>,<i>I</i>)T</b>(<b>&sigma;</b>,<i>I</i>)]<sup>-1</sup><b>T</b><sup>*</sup>(<b>&sigma;</b>,<i>I</i>)<b>d</b>
 <br/>
 <br/>
 The fixed point <b>&sigma;</b>(<i>I</i>) of <b>F</b> is the set of Courant-Snyder parameters for
 the beam current <i>I</i>.  
 </p>
 <p>
 One particularly simply way of solving this problem is to pick an initial
 set of Courant-Snyder parameters <b>&sigma;</b><sub>0</sub>(<i>I</i>) and start iterating the above equation.
 If <b>&sigma;</b><sub>0</sub>(<i>I</i>) is within the region of contraction for the fixed point of 
 <b>F</b> then the iteration converges to the solution.  We can improve the convergence properties by
 forming an outside loop where <i>I</i> is increased from 0 to its target values.  That is, <b>F</b> is
 iterated to its fixed point for each increment of beam current, and that fixed point is used to initialize
 the next iteration.
 <p>
 </p>
 Another more sophisticated technique is a continuation method exploiting the smoothness of 
 <b>F</b>(&middot;, &middot;).  Starting with <b>F</b>[<b>&sigma;</b>(<i>I</i>), <i>I</i>] = <b>&sigma;</b>(<i>I</i>)
 we take the total derivative with respect to <i>I</i> yielding
 <br/>
 <br/>
 &nbsp; &nbsp; &part;<sub>I</sub><b>&sigma;</b>(<i>I</i>) = [<b>Id</b> - &part;<sub><b>&sigma;</b></sub><b>F</b>(<b>&sigma;</b>,<i>I</i>)]<sup>-1</sup>&part;<b>F</b>(<b>&sigma;</b>,<i>I</i>) ,
 <br/>
 <br/>
 where <b>Id</b> is the identity map. Starting from <b>&sigma;</b><sub>0</sub> the solution for <i>I</i> = 0, which can be
 computed exactly, we move along the curves
 <br/>
 <br/>
 &nbsp; &nbsp; <b>&sigma;</b><sub><i>n</i>+1</sub> &#8796; <b>&sigma;</b>(<i>I<sub>n</sub></i> + &Delta;<i>I</i>) = &part;<sub><i>I</i></sub><b>&sigma;</b><i><sub>n</sub></i>&Delta;<i>I</i> + <i>O</i>(&Delta;<i>I</i><sup>2</sup>) .
 <br/>
 <br/>
 The derivatives are recomputed at each step and a brief fixed point iteration is executed to move 
 <b>&sigma;</b><sub><i>n</i></sub> back onto the solution curve <b>&sigma;</b>(&middot;) since the 
 above linear extrapolation cannot account for curvature.
 </p> 
 <p>
 </p>
 There are three classes which perform the Courant-Snyder parameter reconstructions from
 RMS beam size data using the techniques described above.  The other classes in the package
 are support classes for those classes.
 <br/>
 <br/>
 &nbsp; &nbsp; <code><b>CsZeroCurrentEstimator</b></code> - This class is used for
 estimating the Courant-Snyder parameters whenever space charge effects are negligible.
 As described above, in this case it is a direct calculation and very fast.  The class
 should always be used for such a case.
 <br/>
 <br/>
 &nbsp; &nbsp; <code><b>CsFixedPointEstimator</b></code> - This class estimates Courant-Snyder
 parameters using the fixed point iteration method, with space charge.  At current this
 class performs very well; its convergence properties are good and it is fast.
 <br/>
 <br/>
 &nbsp; &nbsp; <code><b>CsContinuationEstimator
 <br/>
 <br>
 If one has the RMS bunch lengths for the longitudinal direction then they can be
 used in the transverse Courant-Snyder calculations.  However, as is usually the case,
 if these values are unknown then the class <code>BunchLengthSimulator</code> can be
 used to estimate them via simulation.
 </p>
 <p>
 The measurement data is packaged in the class <code>Measurement</code>.  Thus,
 the RMS sizes, the beamline locations from which they come, and the desired
 reconstruction location will fill out the attributes of this class.  Class
 instances are then passed to the above reconstruction engines to compute the
 Courant-Snyder values.
 </p></div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>Sep 24, 2014</dd>
</dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../xal/extension/solver/solutionjudge/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../xal/extension/widgets/apputils/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?xal/extension/twissobserver/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
