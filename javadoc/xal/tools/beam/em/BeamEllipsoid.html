<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_31) on Thu Feb 05 15:44:30 EST 2015 -->
<title>BeamEllipsoid</title>
<meta name="date" content="2015-02-05">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BeamEllipsoid";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?xal/tools/beam/em/BeamEllipsoid.html" target="_top">Frames</a></li>
<li><a href="BeamEllipsoid.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">xal.tools.beam.em</div>
<h2 title="Class BeamEllipsoid" class="title">Class BeamEllipsoid</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>xal.tools.beam.em.BeamEllipsoid</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">BeamEllipsoid</span>
extends java.lang.Object</pre>
<div class="block"><p>
 Encapsulates the properties of a ellipsoidally symmetric distribution
 of charge in 6D phase space, in particular, the electromagnetic properties.
 Provides convenience methods for creating arbitrarily oriented ellipsoids
 and determining their fields, and their effects on beam particles, 
 specifically, in the form of a linear transfer matrix generator.
 </p>
 <p>
 The ellipsoid is assumed to be moving in the axial (z-axis) direction
 in the laboratory frame.  All relativistic calculations are made with this
 assumption.  In particular, the gamma (relativistic factor) is taken
 with respect to this axis.
 </p>
 <p>
 The reference ellipsoid in three-space is represented by the equation
 <br/>
 <br/>
 &nbsp; &nbsp;     <b>r</b>'<b>&sigma;</b><sup>-1</sup><b>r</b> = 1
 <br/>
 <br/>
 where <b>&sigma;</b> is the 3&times;3 matrix of spatial moments, 
 <b>r</b> &equiv; (<i>x y z</i>) is the position vector in R3, 
 and the prime indicates transposition.  
 </p>
 <p>
 The matrix <b>&sigma;</b> is taken from the 7&times;7 covariance 
 matrix <b>&tau;</b>
 in homogeneous coordinates; it is the matrix formed from the six, 
 second-order spatial moments &lt;<i>xx</i>&gt;, &lt;<i>xy</i>&gt;, 
 &lt;<i>xz</i>&gt;, &lt;<i>yy</i>&gt;, &lt;<i>yz</i>&gt;, &lt;<i>zz</i>&gt; and is
 arranged as follows:
 <br/>
 <br/>
 <table>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;<i>xx</i>&gt; &lt;<i>xy</i>&gt; &lt;<i>xz</i>&gt; |</td>
   </tr>
   <tr>
     <td><b>&sigma;</b></td> <td> = </td> <td>| &lt;<i>xy</i>&gt; &lt;<i>yy</i>&gt; &lt;<i>yz</i>&gt; |</td>
   </tr>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;<i>xz</i>&gt; &lt;<i>yz</i>&gt; &lt;<i>zz</i>&gt; |</td>
   </tr>
 </table>
 <br/>
 <br/>
 Note that <b>&sigma;</b> must be symmetric and  positive definite.  
 Thus, it is diagonalizable with the decomposition
 <br/>
 <br/>
 &nbsp; &nbsp; <b>&sigma;</b> = <b>R&Lambda;R</b>'
 <br/>
 <br/>
 where the prime indicates transposition, <b>R</b> &isin; <i>SO</i>(3) is the orthogonal 
 rotation matrix and <b>&Lambda;</b> is the diagonal matrix of real eigenvalues.  
 Note from the above that these eigenvalues 
 are the squares of the ellipsoid semi-axes.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#CONST_UNIFORM_BEAM">CONST_UNIFORM_BEAM</a></span></code>
<div class="block">distribution dependence factor - use that for the uniform beam</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#BeamEllipsoid-double-xal.tools.beam.CovarianceMatrix-">BeamEllipsoid</a></span>(double&nbsp;dblGamma,
             <a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a>&nbsp;matSigLab)</code>
<div class="block">
 Construct a beam charge density ellipsoid described
 by the phase space correlation matrix <code>matSigLab</code> and relativistic
 factor <code>gamma</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#BeamEllipsoid-double-xal.tools.math.r3.R3-xal.tools.math.r3.R3-">BeamEllipsoid</a></span>(double&nbsp;dblGamma,
             <a href="../../../../xal/tools/math/r3/R3.html" title="class in xal.tools.math.r3">R3</a>&nbsp;vec1stMmts,
             <a href="../../../../xal/tools/math/r3/R3.html" title="class in xal.tools.math.r3">R3</a>&nbsp;vec2ndMmts)</code>
<div class="block">
 Construct a beam charge density ellipsoid where the second spatial moments
 and axial displacement are given directly.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#compDefocusConstants-double-double:A-">compDefocusConstants</a></span>(double&nbsp;dblGamma,
                    double[]&nbsp;arrMoments)</code>
<div class="block">
 Computes the normalized defocusing constants (squared) for a space charge kick 
 given the second moments of the beam ellipsoid.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#compDefocusConstantsAlaTrace3D-double-double:A-">compDefocusConstantsAlaTrace3D</a></span>(double&nbsp;dblGamma,
                              double[]&nbsp;arrMoments)</code>
<div class="block">This method is provided as a comparison utility for validation against simulation
 with Trace3D.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#computeScheffGenerator-double-">computeScheffGenerator</a></span>(double&nbsp;dblPerveance)</code>
<div class="block">
 Calculates the transfer matrix generator for space charge effects from
 this <code>BeamEllipsoid</code> object given the generalized beam 
 three-dimensional perveance <code>dblPerveance</code>.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#computeScheffMatrix-double-double-">computeScheffMatrix</a></span>(double&nbsp;dblLen,
                   double&nbsp;dblPerveance)</code>
<div class="block">
 Compute and return the transfer matrix for space charge effects due to 
 this beam ellipsoid for the given incremental path lenth <code>dblLen</code>
 and generalized beam <code>dblPerveance</code>.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#get2ndMoments--">get2ndMoments</a></span>()</code>
<div class="block">Return all the ellipsoid second spatial moments in the
 stationary beam frame and aligned to the coordinate axes.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#get2ndMomentX--">get2ndMomentX</a></span>()</code>
<div class="block">Return the value of the first ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#get2ndMomentY--">get2ndMomentY</a></span>()</code>
<div class="block">Return the value of the second ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#get2ndMomentZ--">get2ndMomentZ</a></span>()</code>
<div class="block">Return the value of the third ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getCorrelationBeam--">getCorrelationBeam</a></span>()</code>
<div class="block">Return the correlation matrix for the beam in the 
 stationary beam coordinates.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getCorrelationLab--">getCorrelationLab</a></span>()</code>
<div class="block">Return the original correlation matrix for the beam in the 
 laboratory coordinates.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstants--">getDefocusingConstants</a></span>()</code>
<div class="block">
 Return all the normalized space-charge defocusing constants
 for the beam ellipsoid.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstantX--">getDefocusingConstantX</a></span>()</code>
<div class="block">Return the 1st normalized space charge defocusing constant.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstantY--">getDefocusingConstantY</a></span>()</code>
<div class="block">Return the 2nd normalized space charge defocusing constant.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstantZ--">getDefocusingConstantZ</a></span>()</code>
<div class="block">Return the 3rd normalized space charge defocusing constant.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getGamma--">getGamma</a></span>()</code>
<div class="block">Return the relativistic parameter for the ellipsoidal charge
 distribution.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getLabToBeamTransform--">getLabToBeamTransform</a></span>()</code>
<div class="block">Return the complete transformation from the laboratory inertial
 coordinates to the ellipsoid inertial coordinates.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getLorentzTransform--">getLorentzTransform</a></span>()</code>
<div class="block">Get the Lorentz transform matrix which takes the laboratory coordinates
 to the beam coordinates.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getRotation--">getRotation</a></span>()</code>
<div class="block">
 Get orthogonal rotation matrix <b>R</b> in <i>SO</i>(7) that rotates the ellipsoid
 spatial semi-axes onto the spatial coordinate axes.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>double[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxes--">getSemiAxes</a></span>()</code>
<div class="block">Return all the ellipsoid semi-axes lengths as an array.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxisX--">getSemiAxisX</a></span>()</code>
<div class="block">Return the value of the first ellispoid semi-axis in the
  stationary beam frame.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxisY--">getSemiAxisY</a></span>()</code>
<div class="block">Return the value of the second ellispoid semi-axis in the 
  stationary beam frame.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxisZ--">getSemiAxisZ</a></span>()</code>
<div class="block">Return the value of the third ellispoid semi-axis in the
  stationary beam frame.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code><a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getTranslation--">getTranslation</a></span>()</code>
<div class="block">Return the translation matrix which transforms coordinates in the beam
 frame to those with the ellipsoid centroid as the coordinate origin.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="CONST_UNIFORM_BEAM">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CONST_UNIFORM_BEAM</h4>
<pre>public static final&nbsp;double CONST_UNIFORM_BEAM</pre>
<div class="block">distribution dependence factor - use that for the uniform beam</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BeamEllipsoid-double-xal.tools.beam.CovarianceMatrix-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BeamEllipsoid</h4>
<pre>public&nbsp;BeamEllipsoid(double&nbsp;dblGamma,
                     <a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a>&nbsp;matSigLab)</pre>
<div class="block"><p>
 Construct a beam charge density ellipsoid described
 by the phase space correlation matrix <code>matSigLab</code> and relativistic
 factor <code>gamma</code>. 
 </p>
 <p>
 The correlation matrix <code>matSigLab</code> is taken in laboratory coordinates
 in the laboratory frame.  The beam is assumed to be moving in the axial
 (z-axis) direction in the laboratory frame with relativistic factor 
 <code>dblGamma</code>.  
 </p>
 <p>
 Note that the phase space correlation matrix in homogeneous coordinates
 contains all moments up to and including second order; this includes the
 first-order moments that describe the displacement of the ellipsoid from
 the coordinate origin.  Thus, from the 7x7 phase space correlation matrix
 we extract the displacement vector
 <br/>
 <br/>
 &nbsp; &nbsp;  (&lt;x&gt; &lt;y&gt; &lt;z&gt;)
 <br/>
 <br/>
 and the 3&times;3 covariance matrix <b>&sigma;</b>
 <br/>
 <br/>
 <table>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;x*x&gt; &lt;x*y&gt; &lt;x*z&gt; |</td> <td>&nbsp;</td> <td>| &lt;x&gt;*&lt;x&gt; &lt;x&gt;*&lt;y&gt; &lt;x&gt;*&lt;z&gt; |</td>
   </tr>
   <tr>
     <td><b>&sigma;</b></td> <td>&equiv;</td> <td>| &lt;y*x&gt; &lt;y*y&gt; &lt;y*z&gt; |</td> <td>-</td>  <td>| &lt;y&gt;*&lt;x&gt; &lt;y&gt;*&lt;y&gt; &lt;y&gt;*&lt;z&gt; |</td>
   </tr>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;z*x&gt; &lt;z*y&gt; &lt;z*z&gt; |</td> <td>&nbsp;</td> <td>| &lt;z&gt;*&lt;x&gt; &lt;z&gt;*&lt;y&gt; &lt;z&gt;*&lt;z&gt; |</td>
   </tr>
 </table>
 <br/>
 <br/>
 to construct the ellipsoidal charge object according to the class documentation
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblGamma</code> - relativistic factor</dd>
<dd><code>matSigLab</code> - envelope correlation matrix in homogeneous phase space coordinates</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InstantiationException</code> - could not copy the given covariance matrix</dd>
</dl>
</li>
</ul>
<a name="BeamEllipsoid-double-xal.tools.math.r3.R3-xal.tools.math.r3.R3-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BeamEllipsoid</h4>
<pre>public&nbsp;BeamEllipsoid(double&nbsp;dblGamma,
                     <a href="../../../../xal/tools/math/r3/R3.html" title="class in xal.tools.math.r3">R3</a>&nbsp;vec1stMmts,
                     <a href="../../../../xal/tools/math/r3/R3.html" title="class in xal.tools.math.r3">R3</a>&nbsp;vec2ndMmts)</pre>
<div class="block"><p>
 Construct a beam charge density ellipsoid where the second spatial moments
 and axial displacement are given directly.  These values are taken in the 
 laboratory coordinates and the beam is assumed to be moving in the axial
 (z-axis) direction in the laboratory frame with relativistic factor 
 <code>dblGamma</code>.  
 </p>
 <p>
 The arguments provided include the
 first-order moments <code>vec1stMmts</code> describing the displacement of 
 the beam ellipsoid from the coordinate origin.  This is the vector
 <br/>
 <br/>
 &nbsp; &nbsp;  (&lt;x&gt; &lt;y&gt; &lt;z&gt;)
 <br/>
 <br/>
 The argument <code>vec2ndMmts</code> should be the central spatial moments
 &lt;<i>x</i><sup>2</sup>&gt; - &lt;<i>x</i>&gt;<sup>2</sup>, 
 &lt;<i>y</i><sup>2</sup>&gt; - &lt;<i>y</i>&gt;<sup>2</sup>,
 &lt;<i>z</i><sup>2</sup>&gt; - &lt;<i>z</i>&gt;<sup>2</sup>,
 taken from the central (spatial) covariance matrix
 <br/>
 <br/>
 <table>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;x*x&gt; &lt;x*y&gt; &lt;x*z&gt; |</td> <td>&nbsp;</td> <td>| &lt;x&gt;*&lt;x&gt; &lt;x&gt;*&lt;y&gt; &lt;x&gt;*&lt;z&gt; |</td>
   </tr>
   <tr>
     <td><b>&sigma;</b></td> <td>&equiv;</td> <td>| &lt;y*x&gt; &lt;y*y&gt; &lt;y*z&gt; |</td> <td>-</td>  <td>| &lt;y&gt;*&lt;x&gt; &lt;y&gt;*&lt;y&gt; &lt;y&gt;*&lt;z&gt; |</td>
   </tr>
   <tr>
     <td>&nbsp;</td> <td>&nbsp;</td> <td>| &lt;z*x&gt; &lt;z*y&gt; &lt;z*z&gt; |</td> <td>&nbsp;</td> <td>| &lt;z&gt;*&lt;x&gt; &lt;z&gt;*&lt;y&gt; &lt;z&gt;*&lt;z&gt; |</td>
   </tr>
 </table>
 <br/>
 <br/>
 In this constructor we assume that the beam ellipsoid is aligned with the
 laboratory coordinate axes.  Thus, no rotations are necessary and the process
 of computing the space charge effects is expedited.
 </p>
 <p>
 <h4>NOTES:</h4>
 This constructor has not yet been tested and debugged!
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblGamma</code> - the relativistic factor</dd>
<dd><code>vec1stMmts</code> - vector (&lt;x&gt; &lt;y&gt; &lt;z&gt;) of first spatial moments</dd>
<dd><code>vec2ndMmts</code> - vector (&lt;<i>x</i><sup>2</sup>&gt; - &lt;<i>x</i>&gt;<sup>2</sup>, 
                              &lt;<i>y</i><sup>2</sup>&gt; - &lt;<i>y</i>&gt;<sup>2</sup>,
                              &lt;<i>z</i><sup>2</sup>&gt; - &lt;<i>z</i>&gt;<sup>2</sup>)
                              of second spatial moments</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>Aug 25, 2011</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="compDefocusConstants-double-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>compDefocusConstants</h4>
<pre>public static&nbsp;double[]&nbsp;compDefocusConstants(double&nbsp;dblGamma,
                                            double[]&nbsp;arrMoments)</pre>
<div class="block"><p>
 Computes the normalized defocusing constants (squared) for a space charge kick 
 given the second moments of the beam ellipsoid.  The true defocusing 
 constants are obtained by multiplying the result by the factor <i>K*ds</i>, i.e., 
 <br/>
 <br/>
 &nbsp; &nbsp;  <i>k</i><sup>2</sup> = <i>k<sub>n</sub></i><sup>2</sup><i>K ds</i>
 <br/>
 <br/>
 where <i>k</i><sup>2</sup> is the true defocusing constant, <i>k<sub>n</sub></i><sup>2</sup>
 is the normalized 
 defocusing constant(returned by this method), <i>K</i> is the generalized beam
 perveance, and <i>ds</i> is the incremental path length 
 over which the kick is being applied.
 </p>
 <p>
 The defocusing constants (<i>k<sub>nx</sub>,k<sub>ny</sub>,k<sub>nz</sub></i>)
  are given for the Cartesian 
 coordinate system (<i>x,y,z</i>) which is aligned to the ellipsoid semi-axes.
 If the ellipsoid is rotated with respect to the coordinate system in 
 which the ellipsoid was defined (constructed), then any transfer matrix
 built from these focusing constants must be rotated into the original
 coordinate system.
 </p>
 <p>
 In the natural coordinates of the ellipsoid the normalized focusing constants
 <i>k<sub>n</sub></i> are related to the space charge defocusing lengths <i>f</i> by the
 formula
 <br/>
 <br/>
 &nbsp; &nbsp; <i>f</i> = 1/(<i>ds K k<sub>n<sub></i><sup>2</sup>)
 <br/>
 <br/>
 From an optics standpoint, we are essentially computing the defocusing
 lengths due to space charge forces here.
 </p>
 <p>
 The defocusing constants are computed from a weighted linear
 regression of the true fields generated by an ellipsoidally symmetric 
 charge distribution.  By the equivalent uniform beam principle 
 the space charge effects (to second order) are only loosely
 coupled to the actual profile of the distribution (assuming that 
 it is ellipsoidally symmetric).  The effect from the distribution
 profile manifests itself as a factor, we take this factor to be that
 for a uniform ellipsoid for computational purposes.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblGamma</code> - the relativistic factor 
                      &gamma; &equiv; 1/(1 - <i>v</i><sup>2</sup>/<i>c</i><sup>2</sup>)<sup>1/2</sup>
                      for ellipsoid</dd>
<dd><code>arrMoments</code> - three-array (&lt;<i>x</i><sup>2</sup>&gt;,
                                   &lt;<i>y</i><sup>2</sup>&gt;
                                   &lt;<i>z</i><sup>2</sup>&gt;) 
                                   of ellipsoid spatial second moments</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>three-array (<i>k<sub>nx</sub></i><sup>2</sup>, 
                                   <i>k<sub>ny</sub></i><sup>2</sup>,
                                   <i>k<sub>nz</sub></i><sup>2</sup>) 
                                   of defocusing constants</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="http://lib-www.lanl.gov/cgi-bin/getfile?00796950.pdf">Theory and Technique
      of Beam Envelope Simulation</a></dd>
</dl>
</li>
</ul>
<a name="compDefocusConstantsAlaTrace3D-double-double:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>compDefocusConstantsAlaTrace3D</h4>
<pre>public static&nbsp;double[]&nbsp;compDefocusConstantsAlaTrace3D(double&nbsp;dblGamma,
                                                      double[]&nbsp;arrMoments)</pre>
<div class="block">This method is provided as a comparison utility for validation against simulation
 with Trace3D.  Trace3D uses an approximation to the elliptic integrals encountered
 in the space charge field expressions.  These approximations break down to first order
 as the beam ellipsoid becomes increasingly eccentric in the transverse direction.
 Moreover, there is a preferred direction in these approximations, namely, the 
 axial direction.  The approximation is most valid for the situation where the beam
 is aligned to the axial direction.  Thus, for arbitrarily rotated ellipsoids, the 
 approximation becomes less valid.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblGamma</code> - the relativistic factor 
                      &gamma; &equiv; 1/(1 - <i>v</i><sup>2</sup>/<i>c</i><sup>2</sup>)<sup>1/2</sup>
                      for ellipsoid</dd>
<dd><code>arrMoments</code> - three-array (&lt;xx&gt;,&lt;yy&gt;,&lt;zz&gt;) of ellipsoid spatial second moments</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>three-array (knx^2,kny^2,knz^2) of defocusing constants</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#compDefocusConstants-double-double:A-"><code>compDefocusConstants(double, double[])</code></a></dd>
</dl>
</li>
</ul>
<a name="getGamma--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getGamma</h4>
<pre>public&nbsp;double&nbsp;getGamma()</pre>
<div class="block">Return the relativistic parameter for the ellipsoidal charge
 distribution.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>relativistic parameter &gamma; = (1 + <i>v</i><sup>2</sup>/<i>c</i><sup>2</sup>)<sup>1/2</sup></dd>
</dl>
</li>
</ul>
<a name="getCorrelationLab--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCorrelationLab</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a>&nbsp;getCorrelationLab()</pre>
<div class="block">Return the original correlation matrix for the beam in the 
 laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>beam correlation matrix in laboratory frame</dd>
</dl>
</li>
</ul>
<a name="get2ndMomentX--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get2ndMomentX</h4>
<pre>public&nbsp;double&nbsp;get2ndMomentX()</pre>
<div class="block">Return the value of the first ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>second moment <x*x></dd>
</dl>
</li>
</ul>
<a name="get2ndMomentY--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get2ndMomentY</h4>
<pre>public&nbsp;double&nbsp;get2ndMomentY()</pre>
<div class="block">Return the value of the second ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>second moment <y*y></dd>
</dl>
</li>
</ul>
<a name="get2ndMomentZ--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get2ndMomentZ</h4>
<pre>public&nbsp;double&nbsp;get2ndMomentZ()</pre>
<div class="block">Return the value of the third ellipsoid second spatial moment in the
 stationary beam frame and aligned to the coordinate axes.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>second moment <z*z></dd>
</dl>
</li>
</ul>
<a name="get2ndMoments--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get2ndMoments</h4>
<pre>public&nbsp;double[]&nbsp;get2ndMoments()</pre>
<div class="block">Return all the ellipsoid second spatial moments in the
 stationary beam frame and aligned to the coordinate axes.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>three-array (<x*x>,<y*y>,<z*z>) second moments</dd>
</dl>
</li>
</ul>
<a name="getSemiAxisX--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSemiAxisX</h4>
<pre>public&nbsp;double&nbsp;getSemiAxisX()</pre>
<div class="block">Return the value of the first ellispoid semi-axis in the
  stationary beam frame.  The first value of <code>getSemiAxes()</code>.
  
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>1st semi-axis value</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxes--"><code>getSemiAxes()</code></a></dd>
</dl>
</li>
</ul>
<a name="getSemiAxisY--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSemiAxisY</h4>
<pre>public&nbsp;double&nbsp;getSemiAxisY()</pre>
<div class="block">Return the value of the second ellispoid semi-axis in the 
  stationary beam frame.  The second value of <code>getSemiAxes()</code>.
  
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>2nd semi-axis value</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxes--"><code>getSemiAxes()</code></a></dd>
</dl>
</li>
</ul>
<a name="getSemiAxisZ--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSemiAxisZ</h4>
<pre>public&nbsp;double&nbsp;getSemiAxisZ()</pre>
<div class="block">Return the value of the third ellispoid semi-axis in the
  stationary beam frame.  The third value of <code>getSemiAxes()</code>.
  
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>3rd semi-axis value</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getSemiAxes--"><code>getSemiAxes()</code></a></dd>
</dl>
</li>
</ul>
<a name="getSemiAxes--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSemiAxes</h4>
<pre>public&nbsp;double[]&nbsp;getSemiAxes()</pre>
<div class="block">Return all the ellipsoid semi-axes lengths as an array.
  Note that these semi-axes are the values in the stationary
  beam frame.
  
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>array (a,b,c) of ellipsoid semi-axes</dd>
</dl>
</li>
</ul>
<a name="getDefocusingConstantX--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefocusingConstantX</h4>
<pre>public&nbsp;double&nbsp;getDefocusingConstantX()</pre>
<div class="block">Return the 1st normalized space charge defocusing constant.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>1st normalized defocusing constant knx</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstants--"><code>getDefocusingConstants()</code></a></dd>
</dl>
</li>
</ul>
<a name="getDefocusingConstantY--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefocusingConstantY</h4>
<pre>public&nbsp;double&nbsp;getDefocusingConstantY()</pre>
<div class="block">Return the 2nd normalized space charge defocusing constant.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>2nd normalized defocusing constant knx</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstants--"><code>getDefocusingConstants()</code></a></dd>
</dl>
</li>
</ul>
<a name="getDefocusingConstantZ--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefocusingConstantZ</h4>
<pre>public&nbsp;double&nbsp;getDefocusingConstantZ()</pre>
<div class="block">Return the 3rd normalized space charge defocusing constant.
 
  NOTE
  The after rotation the (x,y,z) coordinate are somewhat arbitrary
  and no longer coincide with the original laboratory coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>3rd normalized defocusing constant knz</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getDefocusingConstants--"><code>getDefocusingConstants()</code></a></dd>
</dl>
</li>
</ul>
<a name="getDefocusingConstants--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDefocusingConstants</h4>
<pre>public&nbsp;double[]&nbsp;getDefocusingConstants()</pre>
<div class="block"><p>
 Return all the normalized space-charge defocusing constants
 for the beam ellipsoid.  These are the inverses of the normalized defocal
 lengths (fnx,fny,fnz) and are used to construct the space charge 
 generator matrix and space charge transfer matrix.  The unnormalized 
 focal lengths <i>f</i> are given by
 <br/>
 <br/>
      f = ds*K*fn
 <br/>
 <br/>     
 where <i>ds</i> is the increment path length over which the space charge 
 kick is being applied, <i>K</i> is the generalized (3D) beam perveance,
 and <i>fn</n> is the normalized defocal length.  The normalized defocal 
 length is given by
 <br/>
 <br/>
      fn = 1/kn^2
 <br/>
 <br/>     
 where <i>kn^2</i> is the normalized (squared) focusing constant, i.e., the value
 returned by this method.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>three-array (knx^2, kny^2, knz^2) of normalized defocusing constants</dd>
</dl>
</li>
</ul>
<a name="getCorrelationBeam--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCorrelationBeam</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/CovarianceMatrix.html" title="class in xal.tools.beam">CovarianceMatrix</a>&nbsp;getCorrelationBeam()</pre>
<div class="block">Return the correlation matrix for the beam in the 
 stationary beam coordinates.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>beam correlation matrix in beam frame</dd>
</dl>
</li>
</ul>
<a name="getLorentzTransform--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLorentzTransform</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;getLorentzTransform()</pre>
<div class="block">Get the Lorentz transform matrix which takes the laboratory coordinates
 to the beam coordinates.  
 
 Note that the laboratory coordinates actually move with the beam centroid
 so they are note truly stationary w.r.t. to the machine.  Thus, the 
 Lorentz transform provided here does not include any translation effects,
 only the effects of length contraction and time dilation.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>relativistic Lorentz transform matrix from lab to beam coordinates</dd>
</dl>
</li>
</ul>
<a name="getTranslation--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTranslation</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;getTranslation()</pre>
<div class="block">Return the translation matrix which transforms coordinates in the beam
 frame to those with the ellipsoid centroid as the coordinate origin.
 <br/><br/>
 Note that because we are using homogeneous coordinates, Galilean translations
 may be performed with matrix multiplications.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>translation matrix moving the coordinate origin to the beam centroid</dd>
</dl>
</li>
</ul>
<a name="getRotation--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRotation</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;getRotation()</pre>
<div class="block"><p>
 Get orthogonal rotation matrix <b>R</b> in <i>SO</i>(7) that rotates the ellipsoid
 spatial semi-axes onto the spatial coordinate axes.
 </p>
 <p>
 The rotation <b>R</b> is actually the Cartesian product of a single rotation 
 <b>r</b> from <i>SO</i>(3) that rotates the ellipsoid's spatial coordinates onto the 
 coordinate axes.  That is,
 <br/>
 <br/>
      <b>R</b> = <b>r</b> &times; <b>r</b> contained in SO(7) contained in <b>R</b><sup>7&times;7</sup>
 <br/>
 <br/>     
 In this manner the momentum coordinates at each point (x,y,z) are rotated 
 by an equal amount and so velocities are mapped accordingly.
 </p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>rotation matrix in SO(7) moving the ellipsoid into standard position</dd>
</dl>
</li>
</ul>
<a name="getLabToBeamTransform--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLabToBeamTransform</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;getLabToBeamTransform()</pre>
<div class="block">Return the complete transformation from the laboratory inertial
 coordinates to the ellipsoid inertial coordinates.  The tranform takes coordinates
 in the laboratory frame to the natural coordinates of the ellipsoid - this 
 coordinate system has the centroid as the origin and the ellipsoid semi-axes
 are aligned to the coordinate axes.  Denoting the returned transformation as
 <b>M</b>, then it is composed of the following factors
 <br/>
 <br/>
  &nbsp; &nbsp;  <b>M</b> = <b>R<sub>0</sub>*T<sub>0</sub>*L<sub>0</sub></b>
 <br/>
 <br/>
 where <b>L<sub>0</sub></b> is the Lorentz transform into the beam frame, <b>T<sub>0</sub></b> is
 the Galilean transform to the ellipsoid centroid coordinates, and <b>R<sub>0</sub></b>
 is the rotation that aligns the ellipsoid semi-axes to the coorinates axes 
 putting it into standard position.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>tranformation taking lab inertial coordinates to beam inertial coordinates</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getLorentzTransform--"><code>getLorentzTransform()</code></a>, 
<a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getTranslation--"><code>getTranslation()</code></a>, 
<a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#getRotation--"><code>getRotation()</code></a></dd>
</dl>
</li>
</ul>
<a name="computeScheffGenerator-double-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeScheffGenerator</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;computeScheffGenerator(double&nbsp;dblPerveance)</pre>
<div class="block"><p>
 Calculates the transfer matrix generator for space charge effects from
 this <code>BeamEllipsoid</code> object given the generalized beam 
 three-dimensional perveance <code>dblPerveance</code>.  
 </p>
 <p>
 Denoting the returned generator matrix as <b>G</b> then the
 actual transfer matrix <b>M</b>(s) for the space charge effect is given as
 <br/>
 <br/>
 &nbsp; &nbsp; <b>M</b>(<i>s</i>) = <i>e</i><sup><i>s</i><b>G</b></sup>
 <br/>
 <br/>
 where <i>s</i> is the incremental path length for the dynamics. 
 </p>
 <p>
 Note that to obtain this matrix a linear fit to the true fields was 
 performed where the regression is weighted by the distribution itself.
 According the "Equivalent Beam" principle by Sacherar this regression
 then only loosely couples to the actual distribution profile of the the
 ellipsoidal charge.  For computational purposes we have assumed a uniform
 density ellipsoid, but that is of no real consequence practically.
 </p>
 <p>
 The resulting generator matrix is the product of the generator matrix 
 <b>G</b><sub>0</sub> in the ellipsoid coordinate (which has a very simple form), and
 a series of matrix transforms.  We have
 <br/>
 <br/>
 &nbsp; &nbsp;  <b>G</b> = (<b>R</b><sub>0</sub><b>T</b><sub>0</sub><b>L</b><sub>0</sub>)<sup>-1</sup>
                           <b>G</b><sub>0</sub> (<b>R</b><sub>0</sub><b>T</b><sub>0</sub><b>L</b><sub>0</sub>)
 <br/>
 <br/>
 where <b>L</b><sub>0</sub> is the Lorentz transform into the beam frame, <b>T0</b> is
 the Galilean transform to the ellipsoid centroid coordinates, and <b>R</b><sub>0</sub>
 is the rotation that aligns the ellipsoid semi-axes to the coorinates axes 
 putting it into standard position.
 </p>
 <p>
 <h4>NOTES:</h4>
 One should provide the three-dimensional value for the generalized beam perveance.
 This value <i>K</i> is defined as
 <br/>
 <br/>
 &nbsp; &nbsp; <i>K</i> = (<i>Q</i>/(2<i>&pi;&epsilon;</i><sub>0</sub>))
                         *(1/(&gamma;<sup>3</sup>&beta;<sup>2</sup>))
                         *(<i>q</i>/(<i>mc</i><sup>2</sup>))
 <br/>
 <br/>
 where <i>Q</i> is the total beam charge, <i>&epsilon;</i><sub>0</sub> is the permittivity of
 free space, <i>&gamma;</i> is the relativistic factor, <i>&beta;</i> is the 
 normalized velocity (to the speed of light), <i>q</i> is the unit charge,
 <i>m</i> is the beam particle mass, and <i>c</i> is the speed of light.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblPerveance</code> - <i>K</i>, the generalized three-dimensional beam perveance</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><b>G</b>, the transfer matrix generator representing 
                          linear space charge effects</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#computeScheffMatrix-double-double-"><code>computeScheffMatrix(double, double)</code></a></dd>
</dl>
</li>
</ul>
<a name="computeScheffMatrix-double-double-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>computeScheffMatrix</h4>
<pre>public&nbsp;<a href="../../../../xal/tools/beam/PhaseMatrix.html" title="class in xal.tools.beam">PhaseMatrix</a>&nbsp;computeScheffMatrix(double&nbsp;dblLen,
                                       double&nbsp;dblPerveance)</pre>
<div class="block"><p>
 Compute and return the transfer matrix for space charge effects due to 
 this beam ellipsoid for the given incremental path lenth <code>dblLen</code>
 and generalized beam <code>dblPerveance</code>.
 </p>
 <p>
 Note that the returned matrix <b>M</b> has the form
 <br/>
 <br/>
 &nbsp; &nbsp; <b>M</b>(<i>s</i>) = <i>exp</i>(<i>s</i><b>G</b>)
 <br/>
 <br/>
 where <i>s</i> is the incremental path length for the dynamics, and <b>G</b>
 is the generator matrix generator for the transform.  This generator matrix
 is returned by the method <code><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#computeScheffGenerator-double-"><code>computeScheffGenerator(double)</code></a></code>,
 thus, we could compute the transfer matrix <b>M</b> simply by exponentiating
 the returned value.  However, because the generator matrix in the ellipsoid 
 coordinates, <b>G<sub>0</sub></b>, is idempotent 
 (i.e., <b>G<sub>0</sub>G<sub>0</sub></b> = 0) it is
 computationally faster to assemble the transfer matrix as the product
 <br/>
 <br/>
 &nbsp; &nbsp; <b>M</b>(<i>s</i>) = <i>e</i><sup><i>s</i><b>G</b></sup> 
                                  = (<b>R<sub>0</sub>T<sub>0</sub>L<sub>0</sub></b>)<sup>-1</sup>
                                    (<b>I</b> + <i>ds</i><b>G<sub>0</sub></b>) 
                                    (<b>R<sub>0</sub>T<sub>0</sub>L<sub>0</sub></b>)
 <br/>
 <br/>
 where <b>L<sub>0</sub></b> is the Lorentz transform into the beam frame, <b>T<sub>0</sub></b> is
 the Galilean transform to the ellipsoid centroid coordinates, and <b>R<sub>0</sub></b>
 is the rotation that aligns the ellipsoid semi-axes to the coorinates axes 
 putting it into standard position.
 </p>
 <p>
 <h4>NOTES:</h4>
 One should provide the three-dimensional value for the generalized beam perveance.
 This value <i>K</i> is defined as
 <br/>
 <br/>
 &nbsp; &nbsp; <i>K</i> = (<i>Q</i>/(2<i>&pi;&epsilon;</i><sub>0</sub>))
                         *(1/(&gamma;<sup>3</sup>&beta;<sup>2</sup>))
                         *(<i>q</i>/(<i>mc</i><sup>2</sup>))
 <br/>
 <br/>
 where <i>Q</i> is the total beam charge, <i>&epsilon;</i><sub>0</sub> is the permittivity of
 free space, <i>&gamma;</i> is the relativistic factor, <i>&beta;</i> is the 
 normalized velocity (to the speed of light), <i>q</i> is the unit charge,
 <i>m</i> is the beam particle mass, and <i>c</i> is the speed of light.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dblLen</code> - <i>ds</i>, the incremental path length for the space charge effects</dd>
<dd><code>dblPerveance</code> - <i>K</i> the generalized three-dimensional beam perveance</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>transfer matrix representing linear space charge effects</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../xal/tools/beam/em/BeamEllipsoid.html#computeScheffGenerator-double-"><code>computeScheffGenerator(double)</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?xal/tools/beam/em/BeamEllipsoid.html" target="_top">Frames</a></li>
<li><a href="BeamEllipsoid.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
