<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Code Migration Log</title>

    <link rel="icon" type="image/png" href="../images/Open XAL Icon.png" />
    <link rel="stylesheet" type="text/css" href="common.css" media="all" />
    <style>
        .tasks .done { background-color: #afa; }
        .tasks .progress { background-color: #ffa; }
        .tasks .paused { background-color: #faa; }
        .tasks .pending { background-color: white; }
        .tasks { font-size: smaller; }
        table.tasks { margin: 1em; }
        table.tasks td.numeric { color: black; }
        table.tasks td.warning { background-color: red; }
        ul.features li { list-style-type: circle }
        .footer { font-style: italic; }
        .token { font-weight: bolder; }
        .literal { font-style: italic; }
        .sample { background-color: #EEE; }
    </style>
</head>

<body>

    <h1>Code Migration Log</h1>

    <h4>C.K. Allen Notes</h4>
    <p>
        <em>April, 2011</em>: Currently moving the online model from J-PARC into the OpenXAL repository
        <br/>
        <br/>
        There is noticeable divergence between the J-PARC and SNS online model codes.  
        I will need to do some merge operations (by hand) and pick one implementation over another
        on many occasions.  I will list them below as I go.  Also many of the identifiers have been changed
        (slightly) in the two repositories.  Once again, I need to choose the one have the least affect
        on the overall OpenXAL repository. 
    </p>

    <p>
        &middot; Renamed <code>DataAdaptor</code> to <code>IDataAdaptor</code> for consistency in the
        J-PARC model.  This action may be too difficult to conform to when migrating the rest of XAL, so
        it may be better to switch back once the model is in.
        <br/>
        <br/>
        &middot; I took the <code>xal.tools.beam</code> from the J-PARC repository.  I remember adding
        many new features.  <b>Note</b>, may need to import some classes in this package from the SNS repository.
        <br/>
        <br/>
        &middot; Migrated most of <code>the gov.sns.tools.math</code> package from the J-PARC repository.
        The classes <code>Complex</code>, <code>DifferentialVariable</code>, and 
        <code>DiscreteFourierTransform</code> were previously in the OpenXAL repository (i.e., they must have
        come from the SNS repository.)
    </p> 
    <p>
    <h1>Future Tasks</h1>
    <br/>
    &middot &nbsp; We need better separation between the model and the SMF components.  There are more than a 
                   few instances of one making direct calls to the other.
    <br/>
    &middot; &nbsp; The element position attribute in the Algorithm object should be moved to the Probe
                    object.  The probe object already contains a lattice position attribute.
    <br/>
    &middot; &nbsp; Need to break out the closed orbit correction in the TransferMap probe to a 
                    separate probe.
    <br/>
    &middot; &nbsp; Need to model refactor the probe mechanism with generics.
    <br/>
    &middot; &nbsp; Change the name of CorrelationMatrix to CovarianceMatrix.
    <br/>
    &middot; &nbsp; Clean up the PMQ mechanism.  Maybe use a different model later,
                    after the current one workds and an be tested.
    <br/>
    &middot; &nbsp; Clean up IdealRfGap.  A lot of stuff was in the wrong place - code was moved to 
                    difference locations but never deleted from IdealRfGap, just deprecated.
    </p>
    &middot; &nbsp; Move xal.model.IArchive to xal.tools.data.
    <p>
    &middot; &nbsp; Eradicate the class <code>xal.tools.em.EllipsoidalCharge</code>.  Right now 
                    Trace3dTracker and EnvelopeTrackerAdapt still use it, and it has many bugs.
    </p>
    <p>
    &middot; &nbsp; <code>EnvelopeTrackerBase</code> uses some deprecated code, especially for 
                    computing emittance growth from phase spread.  Fix it.
    </p>
    <h1>Classes that should be destroyed</h1>
    <br/>
    &middot; &nbsp; <code>xal.tools.beam.RmsEnvelope</code>
    <br/>
    &middot; &nbsp; <code>xal.tools.beam.BunchDescriptor</code>
    <br/>
    &middot; &nbsp; <code>xal.tools.beam.ParameterConverter</code>
    <br/>
    &middot; &nbsp; <code>xal.tools.beam.TranslationMatrix</code>
    <br/>
    &middot; &nbsp; <code>xal.model.IModelDataSource</code>
    <br/>
    &middot; &nbsp; <code>xal.model.Sector</code>
    <br/>
    </p>
</body>

</html>